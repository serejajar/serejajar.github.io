Проверить:
- добавление $inc: { progress: 1000 }, это будет работать не для всех таймеров.
- duration таймеров не должны храниться в базе из=за большой нагрузки, или они каждый раз высчитываются основываясь от времени старта и текущего времени.
-

------------------

8. Базы данных, Нереляционные БД

Вы можете использовать find — аналог SELECT в MySQL. Используется для выборки документов из MongoDB. Возвращает массив документов в виде коллекции, если документов нет — пустую коллекцию. Пример:

db.users.find( { username: “joe”, age: 27 } );
----------------

Вы можете не хранить duration в базе, а каждый раз его высчитывать основываясь от времени старта и текущего времени.




НЕ РАБОТАЕТ так как счёт таймера идёт только на активной странице!!!!!

Насколько я знаю, в mongodb нет доступа к самим данным во время их изменения.
Попробуйте инкремент $inc:
https://docs.mongodb.com/manual/reference/operator/update/inc/#mongodb-update-up.-inc
Напишите мне, если нужна будет помощь с инкрементом.

    Примерно вот так:
      await req.db
        .collection("timers")
        .updateMany({ is_active: true, user_id: req.user._id }, { $inc: { progress: 1000 } });
